# -*- coding: utf-8 -*-
"""
Isotopic Distributions Library for Proteins and Atoms--callable function
In Each Element Definition:
    [(atomic number - 1),[[isotope mass, relative abundance], ...]]
    used to update a list of zeroes y of length x 
    for generating individual atomic isotope distributions
Isotope masses and relative abundances are rounded to 3 and 4 decimal places, respectively, 
    sourced from https://www.nist.gov/pml/atomic-weights-and-isotopic-compositions-relative-atomic-masses
@author: Andrew Swansiger
UPDATE:
    added RNA and DNA libraries
    added unknown average amino acid (X) and nucleotides (x)
"""

import numpy as np

def null(x,y):
###generates the null distribution of no atoms, whatsoever
    ynull = np.insert(y,int(np.argwhere(x==0.000)),1.0000)
    ynull = np.delete(ynull,-1)
    
    nullFT = np.fft.fft(ynull)
    return nullFT

###Dictionary of elemental [isotope masses, relative abundances] up to atomic number 94 
### (every atomic number is off by 1 due to how python inumerates lists)
elem = {"H":[0,[[1.008,0.9999],[2.014,0.0001]]],"He":[1,[[4.003,1.0000]]],"Li":[2,[[6.015,0.0759],[7.016,0.9241]]],"Be":[3,[[9.012,1.0000]]],
        "B":[4,[[10.013,0.1990],[11.009,0.8010]]],"C":[5,[[12.000,0.9893],[13.003,0.0107]]],"N":[6,[[14.003,0.9964],[15.000,0.0036]]],"O":[7,[[15.995,0.9976],[16.999,0.0004],[17.999,0.0020]]],
        "F":[8,[[18.998,1.0000]]],"Ne":[9,[[19.992,0.9048],[20.994,0.0027],[21.991,0.0925]]],"Na":[10,[[22.990,1.000]]],"Mg":[11,[[23.985,0.7899],[24.986,0.1000],[25.983,0.1101]]],
        "Al":[12,[[26.982,1.0000]]],"Si":[13,[[27.977,0.9222],[28.976,0.0469],[29.974,0.0309]]],"P":[14,[[30.974,1.0000]]],"S":[15,[[31.972,0.9499],[32.971,0.0075],[33.968,0.0425],[35.967,0.0001]]],
        "Cl":[16,[[34.969,0.7576],[36.966,0.2424]]],"Ar":[17,[[35.968,0.0033],[37.963,0.0006],[39.962,0.9960]]],"K":[18,[[38.964,0.9326],[39.964,0.0001],[40.962,0.0673]]],"Ca":[19,[[39.963,0.9694],[41.959,0.0065],[42.959,0.0014],[43.955,0.0209],[47.953,0.0019]]],
        "Sc":[20,[[44.956,1.0000]]],"Ti":[21,[[45.953,0.0825],[46.952,0.0744],[47.948,0.7372],[48.948,0.0541],[49.945,0.0518]]],"V":[22,[[49.947,0.0025],[50.944,0.9975]]],"Cr":[23,[[49.946,0.0435],[51.941,0.8379],[52.941,0.0950],[53.939,0.0237]]],
        "Mn":[24,[[54.938,1.0000]]],"Fe":[25,[[53.940,0.0585],[55.935,0.9175],[56.935,0.0212],[57.933,0.0028]]],"Co":[26,[[58.933,1.0000]]],"Ni":[27,[[57.935,0.6808],[59.931,0.2622],[60.931,0.0114],[61.928,0.0363],[63.928,0.0093]]],
        "Cu":[28,[[62.930,0.6915],[64.928,0.3085]]],"Zn":[29,[[63.929,0.4917],[65.926,0.2773],[66.927,0.0404],[67.925,0.1845],[69.925,0.0061]]],"Ga":[30,[[68.926,0.6011],[70.925,0.3989]]],"Ge":[31,[[69.924,0.2057],[71.922,0.2745],[72.923,0.0775],[73.921,0.3650],[75.921,0.0773]]],
        "As":[32,[[74.922,1.0000]]],"Se":[33,[[73.922,0.0089],[75.919,0.0937],[76.920,0.0763],[77.917,0.2377],[79.917,0.4961],[81.917,0.0873]]],"Br":[34,[[78.918,0.5069],[80.916,0.4931]]],"Kr":[35,[[77.920,0.0036],[79.916,0.0229],[81.913,0.1159],[82.914,0.1150],[83.911,0.5699],[85.911,0.1728]]],
        "Rb":[36,[[84.912,0.7217],[86.909,0.2783]]],"Sr":[37,[[83.913,0.0056],[85.909,0.0986],[86.909,0.0700],[87.906,0.8258]]],"Y":[38,[[88.906,1.0000]]],"Zr":[39,[[89.905,0.5145],[90.906,0.1122],[91.905,0.1715],[93.906,0.1738],[95.908,0.0280]]],
        "Nb":[40,[[92.906,1.0000]]],"Mo":[41,[[91.907,0.1453],[93.905,0.0915],[94.906,0.1584],[95.905,0.1667],[96.906,0.0960],[97.905,0.2439],[99.907,0.0982]]],"Tc":[42,[[98.000,1.0000]]],"Ru":[43,[[95.908,0.0554],[97.905,0.0187],[98.906,0.1276],[99.904,0.1260],[100.906,0.1706],[101.904,0.3155],[103.905,0.1862]]],
        "Rh":[44,[[102.906,1.0000]]],"Pd":[45,[[101.906,0.0102],[103.904,0.1114],[104.905,0.2233],[105.903,0.2733],[107.904,0.2646],[109.905,0.1172]]],"Ag":[46,[[106.905,0.5184],[108.905,0.4816]]],"Cd":[47,[[105.906,0.0125],[107.904,0.0089],[109.903,0.1249],[110.904,0.1280],[111.903,0.2413],[112.904,0.1222],[113.903,0.2873],[115.905,0.0749]]],
        "In":[48,[[112.904,0.0429],[114.904,0.9571]]],"Sn":[49,[[111.905,0.0097],[113.903,0.0066],[114.903,0.0034],[115.902,0.1454],[116.903,0.0768],[117.902,0.2422],[118.903,0.0859],[119.902,0.3258],[121.903,0.0463],[123.905,0.0579]]],"Sb":[50,[[120.904,0.5721],[122.904,0.4279]]],"Te":[50,[[119.904,0.0009],[121.903,0.0255],[122.904,0.0089],[123.903,0.0474],[124.904,0.0707],[125.903,0.1884],[127.904,0.3174],[129.906,0.3408]]],
        "I":[52,[[126.904,1.0000]]],"Xe":[53,[[123.906,0.0010],[125.904,0.0009],[127.904,0.0191],[128.905,0.2640],[129.904,0.0407],[130.905,0.2123],[131.904,0.2691],[133.906,0.1044],[135.907,0.0886]]],"Cs":[54,[[132.905,1.0000]]],"Ba":[55,[[129.906,0.0011],[131.905,0.0010],[133.905,0.0242],[134.906,0.0659],[135.905,0.0785],[136.906,0.1123],[137.905,0.7170]]],
        "La":[56,[[137.907,0.0009],[138.906,0.9991]]],"Ce":[57,[[135.907,0.0019],[137.906,0.0025],[139.905,0.8845],[141.909,0.1111]]],"Pr":[58,[[140.908,1.0000]]],"Nd":[59,[[141.908,0.2715],[142.910,0.1217],[143.910,0.2380],[144.913,0.0829],[145.913,0.1719],[147.917,0.0576],[149.921,0.0564]]],
        "Pm":[60,[[145.000,1.0000]]],"Sm":[61,[[143.912,0.0307],[146.915,0.1499],[147.915,0.1124],[148.917,0.1382],[149.917,0.0738],[151.920,0.2675],[153.922,0.2275]]],"Eu":[62,[[150.920,0.4781],[152.921,0.5219]]],"Gd":[63,[[151.920,0.0020],[153.921,0.0218],[154.923,0.1480],[155.922,0.2047],[156.924,0.1565],[157.924,0.2484],[159.926,0.2186]]],
        "Tb":[64,[[158.925,1.0000]]],"Dy":[65,[[155.924,0.0006],[157.924,0.0009],[159.925,0.0233],[160.927,0.1889],[161.927,0.2547],[162.929,0.2490],[163.929,0.2826]]],"Ho":[66,[[164.930,1.0000]]],"Er":[67,[[161.929,0.0014],[163.929,0.0160],[165.930,0.3350],[166.932,0.2287],[167.932,0.2698],[169.935,0.1491]]],
        "Tm":[68,[[168.934,1.0000]]],"Yb":[69,[[167.934,0.0012],[169.935,0.0298],[170.936,0.1409],[171.936,0.2168],[172.938,0.1610],[173.939,0.3203],[175.943,0.1300]]],"Lu":[70,[[174.941,0.9740],[175.943,0.0260]]],"Hf":[71,[[173.940,0.0016],[175.941,0.0526],[176.943,0.1860],[177.944,0.2728],[178.946,0.1362],[179.947,0.3508]]],
        "Ta":[72,[[179.947,0.0001],[180.948,0.9999]]],"W":[73,[[179.947,0.0012],[181.948,0.2650],[182.950,0.1431],[183.951,0.3064],[185.954,0.2843]]],"Re":[74,[[184.953,0.3740],[186.958,0.6260]]],"Os":[75,[[183.952,0.0002],[185.954,0.0159],[186.956,0.0196],[187.956,0.1324],[188.958,0.1615],[189.958,0.2626],[191.961,0.4078]]],
        "Ir":[76,[[190.961,0.3730],[192.963,0.6270]]],"Pt":[77,[[189.960,0.0001],[191.961,0.0078],[193.963,0.3286],[194.965,0.3378],[195.965,0.2521],[197.968,0.0736]]],"Au":[78,[[196.967,1.0000]]],"Hg":[79,[[195.966,0.0015],[197.967,0.0997],[198.968,0.1687],[199.968,0.2310],[200.970,0.1318],[201.971,0.2986],[203.973,0.0687]]],
        "Tl":[80,[[202.972,0.2952],[204.974,0.7048]]],"Pb":[81,[[203.973,0.0140],[205.974,0.2410],[206.976,0.2210],[207.977,0.5240]]],"Bi":[82,[[208.980,1.0000]]],"Po":[83,[[209.000,1.0000]]],
        "At":[84,[[210.000,1.0000]]],"Rn":[85,[[222.000,1.0000]]],"Fr":[86,[[223.000,1.0000]]],"Ra":[87,[[226.000,1.0000]]],
        "Ac":[88,[[227.000,1.0000]]],"Th":[89,[[232.038,1.0000]]],"Pa":[90,[[231.036,1.0000]]],"U":[91,[[234.041,0.0001],[235.044,0.0072],[238.051,0.9927]]],
        "Np":[92,[[237.000,1.0000]]],"Pu":[93,[[244.000,1.0000]]]}

###Dictionary of elemental isotope mass rounding error, to be implemented as an averaged global shift for large counts
mass_drift = {'H':[-0.00017496777,0.00010177812],'He':[-0.00039674587],'Li':[0.0001228874,0.0000034366],'Be':[0.000183065],'B':[-0.00006305,0.00030536],'C':[0.000,0.00035483507],'N':[0.00007400443,0.00010889888],'O':[-0.00008538043,0.00013175650,0.00015961286],'F':[0.00040316273],'Ne':[0.0004441762,-0.000153315,0.000385144],'Na':[-0.000230718],'Mg':[0.000041697,-0.000163024,-0.000407032],
             'Al':[-0.00046147],'Si':[-0.00007346535,0.00049466490,-0.000229864],'P':[-0.00023800158],'S':[0.0000711744,0.0004589098,-0.000132996,0.00008071],'Cl':[-0.000147318,-0.000097398],'Ar':[-0.000454895,-0.00026789,0.0003831237],'K':[-0.0002935136,-0.000001834,-0.0001747421],'Ca':[-0.000409137,-0.00038217,-0.00023356,0.00048156,-0.00047724],'Sc':[-0.00009172],'Ti':[-0.00037228,-0.00024121,-0.00005802,-0.00013432,-0.00021311],'V':[0.00015601,-0.00004296],'Cr':[0.00004183,-0.00049377,-0.00035185,-0.00012084],
             'Mn':[0.00004391],'Fe':[-0,-0,0,0],'Co':[0.00019429],'Ni':[0,-0,0,0,-0],'Cu':[-0,-0],'Zn':[0,0,0,-0,0],'Ga':[-0,-0],'Ge':[0,0,0,0,0],'As':[-0.00040543],'Se':[0,0,-0,0,-0,-0],'Br':[0.0003376,0.0002897],'Kr':[0,0,0,0,0,-0],
             'Rb':[0,0],'Sr':[0,0,0,0],'Y':[0],'Zr':[0,0,0,0,0],'Nb':[0],'Mo':[0,0,0,0,0,0,0],'Tc':[0],'Ru':[0,0,0,0,0,0,0],'Rh':[0],'Pd':[0,0,0,0,0,0],'Ag':[0,0],'Cd':[0,0,0,0,0,0,0,0],
             'In':[0,0],'Sn':[0,0,0,0,0,0,0,0,0,0],'Sb':[0,0],'Te':[0,0,0,0,0,0,0,0],'I':[0],'Xe':[0,0,0,0,0,0,0,0,0],'Cs':[0],'Ba':[0,0,0,0,0,0,0],'La':[0,0],'Ce':[0,0,0,0],'Pr':[0],'Nd':[0,0,0,0,0,0,0],
             'Pm':[0],'Sm':[0,0,0,0,0,0,0],'Eu':[0,0],'Gd':[0,0,0,0,0,0,0],'Tb':[0],'Dy':[0,0,0,0,0,0,0],'Ho':[0],'Er':[0,0,0,0,0,0],'Tm':[0],'Yb':[0,0,0,0,0,0,0],'Lu':[0,0],'Hf':[0,0,0,0,0,0],
             'Ta':[0,0],'W':[0,0,0,0,0],'Re':[0,0],'Os':[0,0,0,0,0,0,0],'Ir':[0,0],'Pt':[0,0,0,0,0,0],'Au':[0],'Hg':[0,0,0,0,0,0,0],'Tl':[0,0],'Pb':[0,0,0,0],'Bi':[0],'Po':[0],
             'At':[0],'Rn':[0],'Fr':[0],'Ra':[0],'Ac':[0],'Th':[0],'Pa':[0],'U':[0,0,0],'Np':[0],'Pu':[0]}

###Dictionary of atomic compositions of naturally occuring amino acid residues at neutral pH
### Letters define number of hydrogens, carbons, nitrogens, oxygens, and sulfurs 
### respectively in each amino acid residue
AA = {"A":[5, 3, 1, 1, 0], "R":[12, 6, 4, 1, 0], "N":[6, 4, 2, 2, 0], "D":[5, 4, 1, 3, 0], 
      "C":[5, 3, 1, 1, 1], "Q":[8, 5, 2, 2, 0], "E":[7, 5, 1, 3, 0], "G":[3, 2, 1, 1, 0], 
      "H":[7, 6, 3, 1, 0], "I":[11, 6, 1, 1, 0], "L":[11, 6, 1, 1, 0], "K":[12, 6, 2, 1, 0], 
      "M":[9, 5, 1, 1, 1], "F":[9, 9, 1, 1, 0], "P":[7, 5, 1, 1, 0], "S":[5, 3, 1, 2, 0], 
      "T":[7, 4, 1, 2, 0], "W":[10, 11, 2, 1, 0], "Y":[9, 9, 1, 2, 0], "V":[9, 5, 1, 1, 0], 
      "X":[7.7583, 4.9384, 1.3577, 1.4773, 0.0417]}
###Average amino acid model "Averagine", used to approximate isotope distributions
### of "Unknown" peptide sequences is given the symbol "X"

###Dictionaries of atomic compositions of naturally occuring nucleic base residues at neutral pH
### Letters define number of hydrogens, carbons, nitrogens, oxygens, and phosphorus 
### respectively in each nucleic base residue (nitrogenous base + pentose + phosphate)
RNA = {"a":[12, 10, 5, 6, 1], "g":[12, 10, 5, 7, 1], "c":[12, 9, 3, 7, 1], "u":[11, 9, 2, 8, 1], "x":[11.75, 9.5, 3.75, 7, 1]}
DNA = {"a":[12, 10, 5, 5, 1], "g":[12, 10, 5, 6, 1], "c":[12, 9, 3, 6, 1], "t":[13, 10, 2, 7, 1], "x":[12.25, 9.75, 3.75, 6, 1]}
###Average nucleic base model "Averagide", used to approximate isotope distributions
### of "Unknown" nucleotide sequences is given the symbol "x", 
### estimated as 25% abundance of each naturally occuring base

